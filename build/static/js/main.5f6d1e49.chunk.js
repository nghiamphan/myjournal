(this["webpackJsonpmyjournal-official-frontend"]=this["webpackJsonpmyjournal-official-frontend"]||[]).push([[0],{44:function(e,t,n){e.exports=n(73)},53:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(22),l=n.n(u),o=n(5),c=(n(53),n(16)),i=n(40),s=n(41),d=n(2),m=n.n(d),p=n(4),f=n(19),E=n(13),b=n.n(E),v="/api/journals",h=null,y={getAll:function(){var e=Object(p.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={headers:{Authorization:h}},!h){e.next=8;break}return e.next=4,b.a.get(v,t);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createJournal:function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,b.a.post(v,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateJournal:function(){var e=Object(p.a)(m.a.mark((function e(t,n){var a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:h}},e.next=3,b.a.put("".concat(v,"/").concat(t),n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteJournal:function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:h}},e.next=3,b.a.delete("".concat(v,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){h="bearer ".concat(e)}},j={journals:[],displayedJournalId:null,journalToUpdateId:null},g=function(e,t){return function(){var n=Object(p.a)(m.a.mark((function n(a){var r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,y.updateJournal(e,t);case 3:r=n.sent,a({type:"UPDATE_JOURNAL",data:r}),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0.message);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},O=function(e){return{type:"SET_DISPLAYED_JOURNAL",id:e}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_JOURNALS":return{journals:t.data,displayedJournalId:t.data.length>0?t.data[t.data.length-1].id:null,journalToUpdateId:null};case"CREATE_JOURNAL":var n=e.journals.concat(t.data).sort((function(e,t){return e.date>t.date?1:-1}));return{journals:n,displayedJournalId:t.data.id,journalToUpdateId:null};case"UPDATE_JOURNAL":return{journals:e.journals.map((function(e){return e.id===t.data.id?t.data:e})),displayedJournalId:t.data.id,journalToUpdateId:null};case"DELETE_JOURNAL":for(var a=null,r=0;r<e.journals.length;r++){var u=e.journals[r];if(u.id===t.id){if(r<e.journals.length-1){a=e.journals[r+1].id;break}if(r>0){a=e.journals[r-1].id;break}}}return{journals:e.journals.filter((function(e){return e.id!==t.id})),displayedJournalId:a,journalToUpdateId:null};case"SET_DISPLAYED_JOURNAL":return Object(f.a)({},e,{displayedJournalId:t.id,journalToUpdateId:null});case"SET_JOURNAL_TO_UPDATE":return Object(f.a)({},e,{displayedJournalId:null,journalToUpdateId:t.id});case"USER_LOGOUT":return j;default:return e}},x={login:function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=JSON.parse(window.localStorage.getItem("loggedInMyJournalAppUser")),A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGIN":return t.user;case"USER_LOGOUT":return null;default:return e}},_=Object(c.combineReducers)({loginRedux:A,journalsRedux:w}),T=Object(c.createStore)(_,Object(i.composeWithDevTools)(Object(c.applyMiddleware)(s.a))),J=n(17),U=n(15),I=n(43),R=function(){var e=Object(o.c)((function(e){return e.journalsRedux.journals})),t=[];e.length>0&&e.map((function(e){if(0===e.todos.filter((function(e){return!e.done})).length){var n=new Date(e.date);n.setMinutes(n.getTimezoneOffset()),t.push(n)}return null}));return r.a.createElement(I.a,{tileClassName:function(e){var n=e.date,a=0;if("month"===e.view)for(var r=a;r<t.length;r++){var u=t[r];if(u.getTime()===n.getTime())return a++,"cross-off-day";u.getTime()<n.getTime()&&a++}return null}})},S=n(7),L=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.journalsRedux.journals}));return r.a.createElement("ul",null,t&&t.length>0&&t.map((function(t){return r.a.createElement("div",{key:t.id,onClick:function(){return e(O(t.id))}},t.date)})))},N=function(e){var t=e.todo,n=Object(o.b)(),a=Object(o.c)((function(e){return e.journalsRedux.journals})),u=Object(o.c)((function(e){return e.journalsRedux.displayedJournalId}));return r.a.createElement("div",null,r.a.createElement("input",{type:"checkbox",checked:t.done,onChange:function(){var e=u?a.find((function(e){return e.id===u})):null,r=Object(f.a)({},t,{done:!t.done}),l=e.todos.map((function(e){return e.id===t.id?r:e})),o=Object(f.a)({},e,{todos:l});n(g(u,o))}}),r.a.createElement("label",null,t.task))},q=function(e){var t=e.bookSummary;return r.a.createElement("li",null,r.a.createElement("strong",null,t.title),": Chapter ",r.a.createElement("i",null,t.chapter)," ",r.a.createElement("br",null),t.content)},C=function(e){var t=e.vocabulary;return r.a.createElement("li",null,r.a.createElement("strong",null,t.word),": ",t.definition)},D=function(e){var t=e.journal;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h2",null,t.date)),0!==t.todos.length&&r.a.createElement("div",null,r.a.createElement("h3",null,"Todos"),r.a.createElement("ul",null,t.todos.map((function(e){return r.a.createElement(N,{key:e.id,todo:e})})))),r.a.createElement("div",null,r.a.createElement("h3",null,"How is your day?"),t.reflection),0!==t.book_summaries.length&&r.a.createElement("div",null,r.a.createElement("h3",null,"Book Summary"),r.a.createElement("ul",null,t.book_summaries.map((function(e){return r.a.createElement(q,{key:e.id,bookSummary:e})})))),0!==t.words_of_today.length&&r.a.createElement("div",null,r.a.createElement("h3",null,"Words of Today"),r.a.createElement("ul",null,t.words_of_today.map((function(e){return r.a.createElement(C,{key:e.id,vocabulary:e})})))))},z=n(14),M=function(e){var t=e.inputArray,n=e.buttonText;return r.a.createElement("button",{onClick:function(e){e.preventDefault(),t.append({})}},n)},P=function(e){var t=e.inputArray,n=e.index;return r.a.createElement("button",{onClick:function(e){e.preventDefault(),t.insert(n+1)}},"add")},G=function(e){var t=e.inputArray,n=e.index;return r.a.createElement("button",{onClick:function(){return t.remove(n)}},"delete")},W=function(e){var t=e.inputArray,n=e.index;return r.a.createElement("button",{onClick:function(e){e.preventDefault(),t.swap(n,Math.max(0,n-1))}},"move up")},Z=function(e){var t=e.inputArray,n=e.index;return r.a.createElement("button",{onClick:function(e){e.preventDefault(),t.swap(n,Math.min(t.fields.length-1,n+1))}},"move down")},F=function(e){var t=e.inputArray,n=e.index;return r.a.createElement(r.a.Fragment,null,r.a.createElement(W,{inputArray:t,index:n}),r.a.createElement(Z,{inputArray:t,index:n}),r.a.createElement(P,{inputArray:t,index:n}),r.a.createElement(G,{inputArray:t,index:n}))},B={padding:12},H=function(){var e=Object(a.useState)(null),t=Object(S.a)(e,2),n=t[0],u=t[1],l=Object(o.c)((function(e){return e.journalsRedux.journals})),c=Object(o.c)((function(e){return e.journalsRedux.journalToUpdateId})),i=c?l.find((function(e){return e.id===c})):null,s=Object(z.b)({defaultValues:i||""}),d=s.register,f=s.control,E=s.handleSubmit,b=s.errors,v=Object(z.a)({control:f,name:"todos"}),h=Object(z.a)({control:f,name:"book_summaries"}),j=Object(z.a)({control:f,name:"words_of_today"}),w=Object(o.b)(),x="This field is required.";return r.a.createElement("form",{onSubmit:E((function(e){if(g?l.find((function(t){return t.date===e.date&&t.id!==c})):l.find((function(t){return t.date===e.date})))u(i?"A journal for ".concat(e.date," already exists. Please choose another date for the edited journal."):"A journal for ".concat(e.date," already exists. If you want to edit the journal for ").concat(e.date,", please choose update function instead."));else{var t={date:e.date,todos:e.todos?e.todos:[],reflection:e.reflection,book_summaries:e.book_summaries?e.book_summaries:[],words_of_today:e.words_of_today?e.words_of_today:[]};w(i?g(c,t):function(e){return function(){var t=Object(p.a)(m.a.mark((function t(n){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.createJournal(e);case 3:a=t.sent,n({type:"CREATE_JOURNAL",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(t))}}))},r.a.createElement("div",{style:B},r.a.createElement("button",{type:"submit"},"save"),r.a.createElement("button",{type:"reset",onClick:function(){w(O(i?c:l[l.length-1].id))}},"cancel")),r.a.createElement("span",null,n),r.a.createElement("div",null,r.a.createElement("h3",null,"Date",r.a.createElement("input",{type:"date",name:"date",ref:d({required:!0})})),b.date&&r.a.createElement("span",null,x)),r.a.createElement("div",null,r.a.createElement("h3",null,"Todos"),0===v.fields.length&&r.a.createElement(M,{inputArray:v,buttonText:"add a task"}),v.fields.map((function(e,t){return r.a.createElement("div",{key:e.id},r.a.createElement("input",{type:"checkbox",name:"todos[".concat(t,"].done"),ref:d()}),r.a.createElement("input",{name:"todos[".concat(t,"].task"),ref:d({required:!0,pattern:/[A-Za-z0-9]+/})}),r.a.createElement(F,{inputArray:v,index:t}))})),b.todos&&r.a.createElement("span",null,x)),r.a.createElement("div",null,r.a.createElement("h3",null,"How is your day?"),r.a.createElement("div",null,r.a.createElement("textarea",{name:"reflection",ref:d({required:!0})})),b.reflection&&r.a.createElement("span",null,x)),r.a.createElement("div",null,r.a.createElement("h3",null,"Book Summaries"),0===h.fields.length&&r.a.createElement(M,{inputArray:h,buttonText:"add a summary"}),h.fields.map((function(e,t){return r.a.createElement("div",{key:e.id,style:B},r.a.createElement("div",null,"Title:",r.a.createElement("input",{name:"book_summaries[".concat(t,"].title"),ref:d({required:!0,pattern:/[A-Za-z0-9]+/})}),"Chapter:",r.a.createElement("input",{name:"book_summaries[".concat(t,"].chapter"),ref:d()})),r.a.createElement("textarea",{placeholder:"chapter summary and your thoughts...",name:"book_summaries[".concat(t,"].content"),ref:d({required:!0,pattern:/[A-Za-z0-9]+/})}),r.a.createElement("br",null),r.a.createElement(F,{inputArray:h,index:t}))})),b.book_summaries&&r.a.createElement("span",null,x)),r.a.createElement("div",null,r.a.createElement("h3",null,"Words of the day"),0===j.fields.length&&r.a.createElement(M,{inputArray:j,buttonText:"add a word"}),j.fields.map((function(e,t){return r.a.createElement("div",{key:e.id,style:B},r.a.createElement("input",{placeholder:"Word",name:"words_of_today[".concat(t,"].word"),ref:d({required:!0,pattern:/[A-Za-z0-9]+/})}),r.a.createElement("input",{placeholder:"Definition...",name:"words_of_today[".concat(t,"].definition"),ref:d({required:!0,pattern:/[A-Za-z0-9]+/})}),r.a.createElement(F,{inputArray:j,index:t}))})),b.words_of_today&&r.a.createElement("span",null,x)))},Y=function(){var e=Object(a.useState)(!1),t=Object(S.a)(e,2),n=t[0],u=t[1],l=Object(o.b)(),c=Object(o.c)((function(e){return e.journalsRedux.journals})),i=Object(o.c)((function(e){return e.journalsRedux.displayedJournalId})),s=i?c.find((function(e){return e.id===i})):null,d=function(){l(O(null)),u(!0)},f=function(){l({type:"SET_JOURNAL_TO_UPDATE",id:i}),u(!0)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"My Journal"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"},r.a.createElement(L,null)),r.a.createElement("div",{className:"col-9"},r.a.createElement("div",null,(s||!n)&&r.a.createElement("button",{onClick:d},"write new journal"),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:f},"update journal"),r.a.createElement("button",{onClick:function(){return l((e=i,function(){var t=Object(p.a)(m.a.mark((function t(n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.deleteJournal(e);case 3:n({type:"DELETE_JOURNAL",id:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()));var e}},"delete journal"))),s?r.a.createElement(D,{journal:s}):n?r.a.createElement(H,null):r.a.createElement("p",null,"Write your first journal..."))))},V=function(){var e=Object(o.b)(),t=Object(z.b)(),n=t.register,a=t.handleSubmit,u=t.errors;return r.a.createElement("div",null,r.a.createElement("h2",null,"Login"),r.a.createElement("form",{onSubmit:a((function(t){var n,a;e((n=t.username,a=t.password,function(){var e=Object(p.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.login({username:n,password:a});case 3:r=e.sent,window.localStorage.setItem("loggedInMyJournalAppUser",JSON.stringify(r)),t({type:"USER_LOGIN",user:r}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message),alert("wrong credentials");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()))}))},r.a.createElement("div",null,"username",r.a.createElement("input",{type:"text",name:"username",ref:n({required:!0,minLength:4})})),u.username&&r.a.createElement("span",null,"This field is required and needs at least 4 characters."),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",name:"password",ref:n({required:!0,minLength:4})})),u.password&&r.a.createElement("span",null,"This field is required and needs at least 4 characters."),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"login"),r.a.createElement("button",null,r.a.createElement(J.b,{to:"/register"},"register")))))},X={register:function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},K=function(){var e=Object(a.useState)(null),t=Object(S.a)(e,2),n=t[0],u=t[1],l=Object(U.g)(),o=Object(z.b)(),c=o.register,i=o.handleSubmit,s=o.errors,d=function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.register(t);case 3:l.push("/login"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),e.t0.response.data.error.includes("`username` to be unique")&&u("Username already exists. Choose another username.");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h2",null,"Registration"),r.a.createElement("form",{onSubmit:i(d)},r.a.createElement("div",null,"username",r.a.createElement("input",{type:"text",name:"username",ref:c({required:!0,minLength:4})})),s.username&&r.a.createElement("span",null,"This field is required and needs at least 4 characters."),r.a.createElement("div",null,"name",r.a.createElement("input",{type:"text",name:"name",ref:c({required:!0})})),s.name&&r.a.createElement("span",null,"This field is required."),r.a.createElement("div",null,"password",r.a.createElement("input",{type:"password",name:"password",ref:c({required:!0,minLength:4})})),s.password&&r.a.createElement("span",null,"This field is required and needs at least 4 characters."),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"register"))),r.a.createElement("span",null,n))},Q=function(){var e=Object(o.c)((function(e){return e.loginRedux}));e&&y.setToken(e.token);var t=Object(o.b)();Object(a.useEffect)((function(){t(function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:(n=e.sent).sort((function(e,t){return e.date>t.date?1:-1})),t({type:"INIT_JOURNALS",data:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t,e]);var n={padding:5};return r.a.createElement("div",{className:"container"},r.a.createElement(J.a,null,e&&r.a.createElement("div",null,r.a.createElement(J.b,{style:n,to:"/calendar"},"X Effect Calendar"),r.a.createElement(J.b,{style:n,to:"/journals"},"Journals"),r.a.createElement("button",{onClick:function(){return t((window.localStorage.removeItem("loggedInMyJournalAppUser"),{type:"USER_LOGOUT"}))}},"logout")),r.a.createElement(U.d,null,r.a.createElement(U.b,{path:"/login"},e?r.a.createElement(U.a,{to:"/calendar"}):r.a.createElement(V,null)),r.a.createElement(U.b,{path:"/register"},r.a.createElement(K,null)),r.a.createElement(U.b,{path:"/calendar"},e?r.a.createElement(R,null):r.a.createElement(U.a,{to:"/login"})),r.a.createElement(U.b,{path:"/journals"},e?r.a.createElement(Y,null):r.a.createElement(U.a,{to:"/login"})))))};l.a.render(r.a.createElement(o.a,{store:T},r.a.createElement(Q,null)),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.5f6d1e49.chunk.js.map